# Code Repository for Submission

This repository contains the source code and analysis scripts used to generate all data figures (Figures 1-5 and Extended Data Figures) in the paper. All code was developed based on Python 3.7.8.

## Project Structure

The repository is organized according to the figure numbers in the paper. The main directory structure is as follows:

* **Figure 1**

  * **Fig. 1b-1i**: `Fig. 1/Fig. 1b-1i_Signal_Processing.py`
* **Figure 2**

  * **Fig. 2a, 2b**: `Fig. 2/Fig. 2a,2b/Fig. 2a,2b_plot_from_pkl.py`
  * **Fig. 2c-2f**: `Fig. 2/Fig. 2c,2d,2e,2f/Fig. 2c,2d,2e,2f_Ridge_Plots.py`
  * **Fig. 2g**: `Fig. 2/Fig. 2g/Fig. 2g_Energy_Envelope_Cloud_Plot.py`
  * **Fig. 2h**: `Fig. 2/Fig. 2h/Fig. 2h_Stability_Hierarchy_Bar_Plot.py`
* **Figure 3**

  * **Fig. 3a**: `Fig. 3/Fig. 3a/Fig. 3a_Density_Distribution_Analysis.py`
  * **Fig. 3b** (and **Extended Data Fig. 3a**): `Fig. 3/Fig. 3b/Fig. 3b_ROC_Permutation_Test.py`
  * **Fig. 3c**: `Fig. 3/Fig. 3c,3d/Fig. 3c_SHAP_Swarm_Plot.py`
  * **Fig. 3d**: `Fig. 3/Fig. 3c,3d/Fig. 3d_Feature_Comparison_Violin.py`
* **Figure 4**

  * **Fig. 4a**: `Fig. 4/Fig. 4a/Fig. 4a_Energy_Ratio_Staircase_Violin.py`
  * **Fig. 4c**: `Fig. 4/Fig. 4c,4d/Fig. 4c_Internal_Validation_ROC.py`
  * **Fig. 4d** (and **Extended Data Fig. 4b, 4c, 4d**): `Fig. 4/Fig. 4c,4d/Fig. 4d_External_Validation_ROC.py`
* **Figure 5**

  * **Fig. 5a, 5b**: `Fig. 5/Fig. 5a,5b/Fig. 5a,5b_plot_from_pkl.py`
  * **Fig. 5c**: `Fig. 5/Fig. 5c/Fig. 5c_Triangular_Radar_Chart.py`
  * **Fig. 5d**: `Fig. 5/Fig. 5d/Fig. 5d_scatter_plots_with_error_bars_Plot.py`
  * **Fig. 5e**: `Fig. 5/Fig. 5e,5f/Fig. 5e_HF_Phenotyping_Internal_Val.py`
  * **Fig. 5f** (and **Extended Data Fig. 4e**): `Fig. 5/Fig. 5e,5f/Fig. 5f_HF_Phenotyping_External_Val.py`
* **Extended Data Figures (Standalone)**

  * **Extended Data Fig. 2**: `Extended Data Fig. 2/Extended Data Fig. 2_Efficiency_Analysis.py`
  * **Extended Data Fig. 3**: `Extended Data Fig. 3/Extended Data Fig. 3_Manhattan_Analysis.py`
  * **Extended Data Fig. 5**: `Extended Data Fig. 5/Extended Data Fig. 5_Feature_selection.py`

> **Note**:
>
> 1. As indicated above, some Extended Data Figures are generated by scripts located in the main Figure directories to prevent code duplication (e.g., Extended Data Figs 3a, 4b-e,5e).
> 2. The code `Extended Data Fig. 5_Feature_selection.py` is provided for reference regarding the analysis method only.

**Data Privacy and Reproducibility Statement:**
    Due to patient privacy and data sensitivity concerns regarding raw clinical data (such as high-precision ECG/SCG waveforms), and subject to ethical review and privacy protection regulations, the raw dataset cannot be publicly shared.

    To ensure transparency and reproducibility of the research results, we provide the original analysis code and code that uses processed and feature-extracted intermediate result files (.pkl) to generate figures consistent with those in the paper.

## Requirements

This project's code was developed and tested in a **Python 3.7.8** environment. It is recommended to use the same or a similar version of Python to ensure reproducibility.

### Core Dependencies

Please use `pip` to install the following core dependencies (see `requirements.txt` for a detailed list):

* **Data Processing**: `numpy`, `pandas`, `scipy`
* **Visualization**: `matplotlib`, `seaborn`
* **Machine Learning**: `scikit-learn`, `joblib`
* **Signal Processing**: `ssqueezepy`
* **Others**: `openpyxl` (for reading Excel files)

## Installation and Usage

1. **Environment Configuration**
   It is recommended to create an independent virtual environment:

   ```bash
   conda create -n paper_env python=3.7.8
   conda activate paper_env
   pip install -r requirements.txt
   ```
2. **Running the Code**
   Navigate to the corresponding figure directory and run the Python script directly. For example, to generate the chart for Figure 2-g:
   cd "Figure 2/Figure 2-g"
   python "Figure 2-g_Energy_Envelope_Cloud_plot_from_pkl.py"


## License & Usage

This project is open-sourced for  **academic research and educational purposes only** .

**Commercial use is strictly prohibited.** This includes, but is not limited to, using this code or any derived models for commercial products, services, or training proprietary algorithms.

If you wish to use this code for commercial purposes, please contact **[Shanghai Ruiwei Digital Tech Co., Ltd./13916165236g@gmail.com]** for licensing inquiries.

Copyright Â© 2026 [Shanghai Ruiwei Digital Tech Co., Ltd.]. All Rights Reserved.
